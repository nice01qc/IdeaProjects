<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>投放管理</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="/assets/scripts/jquery-2.2.3.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/assets/scripts/fakeLoader/fakeLoader.css"/>
    <script type="text/javascript" src="/assets/scripts/fakeLoader/fakeLoader.js"></script>
    <link href="/assets/stylesheets/main.css" rel="stylesheet" type="text/css"/>
    <link href="/assets/stylesheets/new_app.css" rel="stylesheet" type="text/css"/>
    <link href="/assets/stylesheets/pos_delivery_rtp.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="/assets/scripts/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/assets/scripts/mtree/css/mtree.css">
    <script src='/assets/scripts/mtree/js/jquery.velocity.min.js'></script>
    <script type="text/javascript" src="/resources/js/web-common.js"></script>
<body>
<div class="net_container">
    <!--顶部logo start-->
    <div class="net_header"><img src="/assets/images/crm-logo.png"/></div>
    <!--顶部logo end-->
    <!--顶部menu start-->
    <!--<div class="menu">This is the Menu</div>-->
    <!--顶部menu end-->
    <!--内容部分 start-->
    <div class="net_mainContent">
        <!--左侧导航 start-->
        <div class="net_sidebar">
            <ul class="mtree transit" id="mtree">
            </ul>
        </div>
        <!--左侧导航 end-->
        <!--主要内容 start-->
        <div class="content_bg">
            <div class="fakeloader"></div>
            <div class="net_content">
                <div class="content_t">
                    <div class="content_t_l"></div>
                    <div class="content_t_r">投放详情</div>
                    <div class="m_top_20">
                        <button class="button_off font_10" id="backList">返回列表</button>
                    </div>
                </div>
                <!--内容部分 start-->
                <div class="content_m ">
                    <div class="content_m_info" style="width: 100%">
                        <div class="module">
                            <div class="module_l">创建人</div>
                            <div id="account_email" class="module_c"></div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module">
                            <div class="module_l">投放名称</div>
                            <div class="module_c"><input class="input_1 padding_10" type="text" id="promote_name"
                                                         readonly="readonly"/></div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module">
                            <div class="module_l">投放资源</div>
                            <div class="module_c" id="promoteResource">

                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="promoteTerminal" style="display: none;">
                            <div class="module_l">投放终端</div>
                            <div class="module_c" id="promoteTerminal_display">

                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="triggerType" style="display: none;">
                            <div class="module_l">触发方式</div>
                            <div class="module_c" id="triggerType_display">

                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="promoteApp" style="display: none;">
                            <div class="module_l">投放应用</div>
                            <div class="module_c" id="promoteApp_display">

                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="promoteTerType" style="display: none;">
                            <div class="module_l">投放终端类型</div>
                            <div class="module_c" id="promoteTerType_display">

                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="promoteAppClass" style="display: none;">
                            <div class="module_l">投放应用分类</div>
                            <div id="proAppType_ios" style="display: none;">
                                <div class="module_c">
                                    &nbsp;IOS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <div class="clearfloat"></div>
                                </div>
                                <div class="module_c_info m_left_30" id="proAppType_ios_info" style="display: none;">
                                </div>
                                <div class="clearfloat"></div>
                            </div>
                            <div id="proAppType_ios_append"
                                 style="width:90px;height:30px;float:left;display: none;"></div>

                            <div id="proAppType_android" style="display: none;">
                                <div class="module_c ">
                                    &nbsp;Android&nbsp;&nbsp;
                                    <div class="clearfloat"></div>
                                </div>
                                <div class="module_c_info m_left_30" id="proAppType_android_info"
                                     style="display: none;">
                                </div>
                                <div class="clearfloat"></div>
                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module">
                            <div class="module_l">资源位类型</div>
                            <div class="module_c m_right_20">
                                <select class="select_s" id="resourceType" disabled="disabled"></select>
                            </div>
                            <div class="module_c_input">
                                <textarea id="resourceName" rows="3"
                                          style="width:250px;height:auto;float:left;border:1px solid #f7f7f7;border-radius:2px;background-color:#f7f7f7;resize: none;display: none;"
                                          readonly="readonly"></textarea>
                                <div class="clearfloat"></div>
                            </div>
                        </div>
                        <div class="module">
                            <div class="module_l">关联创意</div>
                            <div class="module_c_input" style="float: left;width: 80%;">
                                <textarea id="creationInfo" rows="3" class=" padding_10"
                                          style="width:381px;height:auto;border:1px solid #f7f7f7;border-radius:2px;background-color:#f7f7f7;resize: none;"
                                          readonly="readonly">广告创意001   图片轮播 任意外链：www.123456.cm</textarea>
                                <br/>
                                <div class="module_c" id="creationPicSection">
                                </div>
                            </div>
                            <div class="clearfloat"></div>
                        </div>

                        <div class="module" id="trackingLinksDiv" style="display: none;">
                            <div class="module_l">第三方监控</div>
                            <div class="module_c" id="trackingLinks"></div>
                            <div class="clearfloat"></div>
                        </div>

                        <div class="middle_line"></div>
                        <div class="module">
                            <div class="module_l">结算方式</div>
                            <div class="module_c" id="settleType_display">

                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module">
                            <div class="module_l">投放日期</div>
                            <div id="promoteDateList" class="module_c">
                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="timeDirect" style="display: none;">
                            <div class="module_l">时间定向</div>
                            <div class="module_c">
                                <button id="timeDirect_0" class="button_on font_10" style="display: none;">不限</button>
                                <button id="timeDirect_1" class="button_off font_10 " style="display: none;"
                                        onclick="timepopup()">查看设定
                                </button>
                            </div>
                            <div class="clearfloat"></div>
                        </div>


                        <!-- <div class="module">
                            <div class="module_l">地域定向</div>
                            <div class="module_c">
                                <button id="regionDirect_0" class="button_on font_10" style="display: none;">不限</button>
                                <button id="regionDirect_1" class="button_off font_10 m_top_5" style="display: none;"
                                        onclick="popup()">查看设定
                                </button>
                            </div>
                            <div class="clearfloat"></div>
                        </div> -->

                        <div class="module">
                            <div class="module_l">地域投放方式</div>
                            <div class="module_c" id="promoteTarget" style="width: 80%"></div>
                            <div class="clearfloat"></div>
                        </div>

                        <div class="module">
                            <div class="module_l">定向条件</div>
                            <div class="module_c" id="programTargetting" style="width: 80%"></div>
                            <div class="clearfloat"></div>
                        </div>

                        <div class="module" id="promoteDisplay" style="display: none;">
                            <div class="module_l">投放展示频次</div>
                            <div class="module_c">
                                <div class="module_c_input">
                                    <select class="select_s m_left_10" id="displayType" disabled="disabled"></select>
                                    <input class="input_6 padding_10" type="text" id="displayFreq" readonly="readonly"/>人次
                                </div>
                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="promoteClick" style="display: none;">
                            <div class="module_l">投放点击频次</div>
                            <div class="module_c">
                                <div class="module_c_input">
                                    <select class="select_s m_left_10" id="clickType" disabled="disabled"></select>
                                    <input class="input_6 padding_10" type="text" id="clickFreq" readonly="readonly"/>人次
                                </div>
                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="budgetArea" style="display: none;">
                            <div class="module_l">每日预算</div>
                            <div class="module_c">
                                <div class="module_c_input">
                                    <input class="input_6 padding_10" type="text" id="budget" readonly="readonly"/>元
                                </div>
                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="maxBidArea" style="display: none;">
                            <div class="module_l">每高出价</div>
                            <div class="module_c">
                                <div class="module_c_input ">
                                    <input class="input_6 padding_10" type="text" id="maxBid" readonly="readonly"/><span
                                        id="maxBidFont" class="span_rtp1"></span>
                                </div>
                            </div>
                            <div class="clearfloat"></div>
                        </div>
                        <div class="module" id="costArea" style="display: none;">
                            <div class="module_l">费用</div>
                            <div class="module_c">
                                <div class="module_c_input">
                                    <span id="cost"></span>
                                </div>
                            </div>
                            <div class="clearfloat"></div>
                        </div>
                    </div>
                    <div class="clearfloat"></div>
                </div>
                <!--内容部分 end-->
                <div class="clearfloat"></div>

            </div>
        </div>
        <!--主要内容 end-->
        <div class="clearfloat"></div>
    </div>
</div>

<!-- 
<div class="tc_bg" id="bgdiv">
    <div class="popup">
        <div class="popup_title">地域设定</div>
        <div class="popup_content">
            <div class="content_m_info">
                <div class="module">
                    <div class="module_c" id="promoteRegioBoList"></div>
                </div>
            </div>
            <div class="clearfloat"></div>
        </div>
        <div class="clearfloat"></div>
        <div class="popup_button">
            <button class="popup_button_blue" onclick="submitpass();">确定</button>
        </div>
    </div>
</div>
-->

<div class="tc_bg" id="timediv">
    <div class="popup_time">
        <div class="popup_title">时间设定</div>
        <table id="timeTable" border="1" cellspacing="0" cellpadding="0" style="text-align: center;margin:0px auto;">
            <tr>
                <th rowspan="2" width="100px"></th>
                <th colspan="7">凌晨时段</th>
                <th colspan="4">上午时段</th>
                <th colspan="4">中午时段</th>
                <th colspan="4">下午时段</th>
                <th colspan="5">夜晚时段</th>
            </tr>
            <tr>
                <th width="30px">0</th>
                <th width="30px">1</th>
                <th width="30px">2</th>
                <th width="30px">3</th>
                <th width="30px">4</th>
                <th width="30px">5</th>
                <th width="30px">6</th>
                <th width="30px">7</th>
                <th width="30px">8</th>
                <th width="30px">9</th>
                <th width="30px">10</th>
                <th width="30px">11</th>
                <th width="30px">12</th>
                <th width="30px">13</th>
                <th width="30px">14</th>
                <th width="30px">15</th>
                <th width="30px">16</th>
                <th width="30px">17</th>
                <th width="30px">18</th>
                <th width="30px">19</th>
                <th width="30px">20</th>
                <th width="30px">21</th>
                <th width="30px">22</th>
                <th width="30px">23</th>
            </tr>
            <tr id="r0" class="rowTask">
                <td width="100px">星期一</td>
                <td width="30px" id="c0"></td>
                <td width="30px" id="c1"></td>
                <td width="30px" id="c2"></td>
                <td width="30px" id="c3"></td>
                <td width="30px" id="c4"></td>
                <td width="30px" id="c5"></td>
                <td width="30px" id="c6"></td>
                <td width="30px" id="c7"></td>
                <td width="30px" id="c8"></td>
                <td width="30px" id="c9"></td>
                <td width="30px" id="c10"></td>
                <td width="30px" id="c11"></td>
                <td width="30px" id="c12"></td>
                <td width="30px" id="c13"></td>
                <td width="30px" id="c14"></td>
                <td width="30px" id="c15"></td>
                <td width="30px" id="c16"></td>
                <td width="30px" id="c17"></td>
                <td width="30px" id="c18"></td>
                <td width="30px" id="c19"></td>
                <td width="30px" id="c20"></td>
                <td width="30px" id="c21"></td>
                <td width="30px" id="c22"></td>
                <td width="30px" id="c23"></td>
            </tr>
            <tr id="r1" class="rowTask">
                <td width="100px">星期二</td>
                <td width="30px" id="c0"></td>
                <td width="30px" id="c1"></td>
                <td width="30px" id="c2"></td>
                <td width="30px" id="c3"></td>
                <td width="30px" id="c4"></td>
                <td width="30px" id="c5"></td>
                <td width="30px" id="c6"></td>
                <td width="30px" id="c7"></td>
                <td width="30px" id="c8"></td>
                <td width="30px" id="c9"></td>
                <td width="30px" id="c10"></td>
                <td width="30px" id="c11"></td>
                <td width="30px" id="c12"></td>
                <td width="30px" id="c13"></td>
                <td width="30px" id="c14"></td>
                <td width="30px" id="c15"></td>
                <td width="30px" id="c16"></td>
                <td width="30px" id="c17"></td>
                <td width="30px" id="c18"></td>
                <td width="30px" id="c19"></td>
                <td width="30px" id="c20"></td>
                <td width="30px" id="c21"></td>
                <td width="30px" id="c22"></td>
                <td width="30px" id="c23"></td>
            </tr>
            <tr id="r2" class="rowTask">
                <td width="100px">星期三</td>
                <td width="30px" id="c0"></td>
                <td width="30px" id="c1"></td>
                <td width="30px" id="c2"></td>
                <td width="30px" id="c3"></td>
                <td width="30px" id="c4"></td>
                <td width="30px" id="c5"></td>
                <td width="30px" id="c6"></td>
                <td width="30px" id="c7"></td>
                <td width="30px" id="c8"></td>
                <td width="30px" id="c9"></td>
                <td width="30px" id="c10"></td>
                <td width="30px" id="c11"></td>
                <td width="30px" id="c12"></td>
                <td width="30px" id="c13"></td>
                <td width="30px" id="c14"></td>
                <td width="30px" id="c15"></td>
                <td width="30px" id="c16"></td>
                <td width="30px" id="c17"></td>
                <td width="30px" id="c18"></td>
                <td width="30px" id="c19"></td>
                <td width="30px" id="c20"></td>
                <td width="30px" id="c21"></td>
                <td width="30px" id="c22"></td>
                <td width="30px" id="c23"></td>
            </tr>
            <tr id="r3" class="rowTask">
                <td width="100px">星期四</td>
                <td width="30px" id="c0"></td>
                <td width="30px" id="c1"></td>
                <td width="30px" id="c2"></td>
                <td width="30px" id="c3"></td>
                <td width="30px" id="c4" class=""></td>
                <td width="30px" id="c5"></td>
                <td width="30px" id="c6"></td>
                <td width="30px" id="c7"></td>
                <td width="30px" id="c8"></td>
                <td width="30px" id="c9"></td>
                <td width="30px" id="c10"></td>
                <td width="30px" id="c11"></td>
                <td width="30px" id="c12"></td>
                <td width="30px" id="c13"></td>
                <td width="30px" id="c14"></td>
                <td width="30px" id="c15"></td>
                <td width="30px" id="c16"></td>
                <td width="30px" id="c17"></td>
                <td width="30px" id="c18"></td>
                <td width="30px" id="c19"></td>
                <td width="30px" id="c20"></td>
                <td width="30px" id="c21"></td>
                <td width="30px" id="c22"></td>
                <td width="30px" id="c23"></td>
            </tr>
            <tr id="r4" class="rowTask">
                <td width="100px">星期五</td>
                <td width="30px" id="c0"></td>
                <td width="30px" id="c1"></td>
                <td width="30px" id="c2"></td>
                <td width="30px" id="c3"></td>
                <td width="30px" id="c4"></td>
                <td width="30px" id="c5"></td>
                <td width="30px" id="c6"></td>
                <td width="30px" id="c7"></td>
                <td width="30px" id="c8"></td>
                <td width="30px" id="c9"></td>
                <td width="30px" id="c10"></td>
                <td width="30px" id="c11"></td>
                <td width="30px" id="c12"></td>
                <td width="30px" id="c13"></td>
                <td width="30px" id="c14"></td>
                <td width="30px" id="c15"></td>
                <td width="30px" id="c16"></td>
                <td width="30px" id="c17"></td>
                <td width="30px" id="c18"></td>
                <td width="30px" id="c19"></td>
                <td width="30px" id="c20"></td>
                <td width="30px" id="c21"></td>
                <td width="30px" id="c22"></td>
                <td width="30px" id="c23"></td>
            </tr>
            <tr id="r5" class="rowTask">
                <td width="100px">星期六</td>
                <td width="30px" id="c0"></td>
                <td width="30px" id="c1"></td>
                <td width="30px" id="c2"></td>
                <td width="30px" id="c3"></td>
                <td width="30px" id="c4"></td>
                <td width="30px" id="c5"></td>
                <td width="30px" id="c6"></td>
                <td width="30px" id="c7"></td>
                <td width="30px" id="c8"></td>
                <td width="30px" id="c9"></td>
                <td width="30px" id="c10"></td>
                <td width="30px" id="c11"></td>
                <td width="30px" id="c12"></td>
                <td width="30px" id="c13"></td>
                <td width="30px" id="c14"></td>
                <td width="30px" id="c15"></td>
                <td width="30px" id="c16"></td>
                <td width="30px" id="c17"></td>
                <td width="30px" id="c18"></td>
                <td width="30px" id="c19"></td>
                <td width="30px" id="c20"></td>
                <td width="30px" id="c21"></td>
                <td width="30px" id="c22"></td>
                <td width="30px" id="c23"></td>
            </tr>
            <tr id="r6" class="rowTask">
                <td width="100px">星期日</td>
                <td width="30px" id="c0"></td>
                <td width="30px" id="c1"></td>
                <td width="30px" id="c2"></td>
                <td width="30px" id="c3"></td>
                <td width="30px" id="c4"></td>
                <td width="30px" id="c5"></td>
                <td width="30px" id="c6"></td>
                <td width="30px" id="c7"></td>
                <td width="30px" id="c8"></td>
                <td width="30px" id="c9"></td>
                <td width="30px" id="c10"></td>
                <td width="30px" id="c11"></td>
                <td width="30px" id="c12"></td>
                <td width="30px" id="c13"></td>
                <td width="30px" id="c14"></td>
                <td width="30px" id="c15"></td>
                <td width="30px" id="c16"></td>
                <td width="30px" id="c17"></td>
                <td width="30px" id="c18"></td>
                <td width="30px" id="c19"></td>
                <td width="30px" id="c20"></td>
                <td width="30px" id="c21"></td>
                <td width="30px" id="c22"></td>
                <td width="30px" id="c23"></td>
            </tr>
        </table>
        <div class="popup_button">
            <button class="popup_button_blue" onclick="timesubmitpass();">确定</button>
        </div>
        <div class="clearfloat"></div>
    </div>
</div>
<script>
    function convertTimestamp(unixTime, isFull, timeZone) {
        if (typeof(timeZone) == 'number') {
            unixTime = parseInt(unixTime) + parseInt(timeZone) * 60 * 60 * 1000;
        }
        var time = new Date(unixTime);
        var ymdhis = "";
        ymdhis += time.getUTCFullYear() + "-";
        ymdhis += time.getUTCMonth() + 1 + "-";
        ymdhis += time.getUTCDate();
        if (isFull === true) {
            ymdhis += " " + time.getUTCHours() + ":";
            ymdhis += time.getUTCMinutes() + ":";
            ymdhis += time.getUTCSeconds();
        }
        return ymdhis;
    }
    $(document).ready(
            function () {

                $(".fakeloader").fakeLoader({
                    bgColor: "#3498db",
                    spinner: "spinner1"
                });

                var promoteId = location.search.substr(11);

                //资源位类型下拉列表值初始化
                $.ajax({
                    type: "GET",
                    url: "/promote/selectByCode",
                    data: {pKey: "resource_info.res_positiontype"},
                    dataType: "json",
                    async: false,
                    success: function (resourceTypeList) {
                        //动态循环追加下拉列表
                        $.each(resourceTypeList, function (i, n) {
                            $('#resourceType').append('<option value="' + resourceTypeList[i].columnValue + '">' + resourceTypeList[i].columnDesc + '</option>');
                        });

                    }
                });

                //投放展示频次下拉列表值初始化
                $.ajax({
                    type: "GET",
                    url: "/promote/selectByCode",
                    data: {pKey: "t_ffad_promote.display_type"},
                    dataType: "json",
                    async: false,
                    success: function (displayTypeList) {
                        //动态循环追加下拉列表
                        $.each(displayTypeList, function (i, n) {
                            $('#displayType').append('<option value="' + displayTypeList[i].columnValue + '">' + displayTypeList[i].columnDesc + '</option>');
                        });

                    }
                });

                //投放点击频次下拉列表值初始化
                $.ajax({
                    type: "GET",
                    url: "/promote/selectByCode",
                    data: {pKey: "t_ffad_promote.click_type"},
                    dataType: "json",
                    async: false,
                    success: function (clickTypeList) {
                        //动态循环追加下拉列表
                        $.each(clickTypeList, function (i, n) {
                            $('#clickType').append('<option value="' + clickTypeList[i].columnValue + '">' + clickTypeList[i].columnDesc + '</option>');
                        });

                    }
                });

                //查询投放相关信息并回显
                $.ajax({
                    "method": "post",
                    "contentType": "application/json",
                    "url": '/promote/info',
                    "dataType": "json",
                    "data": JSON.stringify({
                        "promoteId": promoteId
                    }),
                    "success": function (promoteBo) {
                        if (promoteBo == null) {
                            window.location.href = "404.html";
                        }
                        //返回正确页面
                        else {
                            //创建人
                            $('#account_email').text(promoteBo.accountEmail);
                            //投放名称
                            $('#promote_name').val(promoteBo.promoteName);

                            //显示投放资源
                            $('#promoteResource').append('<input type="radio" checked="checked"/>');
                            $('#promoteResource').append('<span class="input_radio">' + "  " + promoteBo.promoteResourceDesc + '</span>');

                            //飞凡
                            if (promoteBo.promoteResource == 0) {
                                //显示投放终端
                                $('#promoteTerminal').show();
                                $('#promoteTerminal_display').append('<input type="radio" checked="checked"/>');
                                $('#promoteTerminal_display').append('<span class="input_radio">' + "  " + promoteBo.promoteTerminalDesc + '</span>');

                                //APP 或  Beacon
                                if (promoteBo.promoteTerminal == 0 || promoteBo.promoteTerminal == 2) {
                                    //显示投放应用
                                    $('#promoteApp').show();
                                    $.each(promoteBo.promoteApps, function (i, entity) {
                                        $('#promoteApp_display').append('<input type="radio" checked="checked"/>');
                                        $('#promoteApp_display').append('<span class="input_radio">' + "  " + entity.promoteAppDesc + '</span>');
                                    });
                                }
                            }
                            //联盟
                            else if (promoteBo.promoteResource == 1) {
                                //显示触发方式
                                $('#triggerType').show();
                                $('#triggerType_display').append('<input type="radio" checked="checked"/>');
                                $('#triggerType_display').append('<span class="input_radio">' + "  " + promoteBo.promoteTerminalDesc + '</span>');

                                //显示投放终端类型
                                $('#promoteTerType').show();
                                $.each(promoteBo.promoteApps, function (i, entity) {
                                    $('#promoteTerType_display').append('<input type="radio" checked="checked"/>');
                                    $('#promoteTerType_display').append('<span class="input_radio">' + "  " + entity.promoteAppDesc + '</span>');
                                });
                            }

                            //资源位类型
                            $('#resourceType').val(promoteBo.resourceType);

                            //只有定制轮播资源位才有显示资源信息框
                            if (promoteBo.resourceType == 4) {

                                $('#resourceName').show();
                                //资源ID、资源名称
                                $('#resourceName').val("资源ID:" + promoteBo.resourceId + "\n" + "资源名称:" + promoteBo.resourceName + "\n第" + promoteBo.frameIndex + "帧");
                            }

                            <!--投放应用分类begin-->

                            var appCateiOS = {};
                            var appCateAndroid = {};
                            $.ajax({
                                type: "GET",
                                url: "/promote/selectByCode",
                                data: {pKey: "t_ffad_promote_app_cate.app_cate_ios"},
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    appCateiOS = data;
                                }
                            });

                            $.ajax({
                                type: "GET",
                                url: "/promote/selectByCode",
                                data: {pKey: "t_ffad_promote_app_cate.app_cate_android"},
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    appCateAndroid = data;
                                }
                            });
                            var find = function (sys, code) {
                                if (sys == "Android") {
                                    for (var i = 0; i < appCateAndroid.length; i++) {
                                        if (code == appCateAndroid[i].columnValue) {
                                            return appCateAndroid[i].columnDesc;
                                        }
                                    }
                                } else {
                                    for (var i = 0; i < appCateiOS.length; i++) {
                                        if (code == appCateiOS[i].columnValue) {
                                            return appCateiOS[i].columnDesc;
                                        }
                                    }
                                }
                            }

                            //投放应用分类动态添加
                            var appType = "";
                            var appCateBoAndroid = '<div class="module_c">';
                            var appCateBoiOS = '<div class="module_c">';
                            var androidCount = 0;
                            var iosCount = 0;
                            $.each(promoteBo.promoteAppCateBoList, function (i, n) {
                                if (appType.indexOf(n.appTypeDesc) < 0) {
                                    appType += n.appTypeDesc + "&nbsp;"
                                }
                                if (n.appType == 3) {
                                    androidCount++;
                                    appCateBoAndroid += '<span class="label label-info">' + find('Android', n.cateId) + "</span> ";
                                } else {
                                    iosCount++;
                                    appCateBoiOS += '<span class="label label-info">' + find('iOS', n.cateId) + "</span> ";
                                }
                            });

                            //有投放应用分类，则显示，没有不显示
                            if (iosCount > 0) {
                                $("#promoteAppClass").show();
                                $("#proAppType_ios").show();
                                $("#proAppType_ios_info").append(appCateBoiOS + "</div>");
                                $("#proAppType_ios_info").show();
                                $("#proAppType_ios_append").show();
                            }
                            if (androidCount > 0) {
                                $("#promoteAppClass").show();
                                $("#proAppType_android").show();
                                $("#proAppType_android_info").append(appCateBoAndroid + "</div>");
                                $("#proAppType_android_info").show();
                            }
                            <!--投放应用分类end-->

                            //关联创意信息
                            var creationInfo = "创意ID:" + promoteBo.creationId + "\n创意名称:" + promoteBo.creationName + "  资源位类型:" + promoteBo.resourceTypeDesc + "\n";
                            //有些情况没有创意链接类型，不显示
                            if (promoteBo.creationLinkUrl != undefined && promoteBo.creationLinkUrl != "") {
                                creationInfo = creationInfo + "创意连接内容:" + promoteBo.creationLinkUrl;
                            }
                            $('#creationInfo').val(creationInfo);

                            $('#creationPicSection').html("<button id='btnShowCreativePics' type='button' class='btn btn-default' onclick='javascript:showCreationPics(" + promoteBo.creationId + ");'>查看素材<i class='glyphicon glyphicon-triangle-bottom'></i></button><div id='creativePics'></div>");

                            //第三方监控
                            if (promoteBo.trackingLinks) {
                                var target = $("#trackingLinksDiv #trackingLinks");
                                $(promoteBo.trackingLinks).each(function (i, val) {
                                    target.append("<div class='group_title'>第" + Arabia_To_SimplifiedChinese(i + 1) + "组监控链接</div>");
                                    if (val.exposureLink) {
                                        target.append("<div>曝光监控：" + val.exposureLink + "</div>");
                                    }
                                    if (val.clickLink) {
                                        target.append("<div>点击监控：" + val.clickLink + "</div>");
                                    }
                                });
                                $("#trackingLinksDiv").show();
                            }

                            //结算方式
                            $('#settleType_display').append('<input type="radio" checked="checked"/>');
                            $('#settleType_display').append('<span class="input_radio">' + "  " + promoteBo.settleTypeDesc + '</span>');

                            //投放日期
                            for (i in promoteBo.promoteDateList) {
                                var d = promoteBo.promoteDateList[i];

                                // timestamp格式转换
                                var startDate = convertTimestamp(d.startDate, false, 8);
                                var endDate = convertTimestamp(d.endDate, false, 8);

                                //动态追加一对开始结束日期
                                $('#promoteDateList').append('<div class="module_c_input" style="margin-left: -10px;"><input class="input_6" type="text" value="' + startDate + '" readonly="readonly">至<input class="input_6" value="' + endDate + '" type="text" readonly="readonly"></div>');
                            }

                            //时间定向
                            if (promoteBo.timeDirect == 0) {
                                //显示不限按钮
                                $('#timeDirect_0').show();
                            }
                            else if (promoteBo.timeDirect == 1) {
                                //显示查看设定按钮
                                $('#timeDirect_1').show();
                            }
                            //时间定向弹出框
                            $.each(promoteBo.promoteTimeList, function (i, n) {
                                var $weekTr = $("#r" + (n.weekDay - 1));
                                var hours = n.timeDirect.split(",");
                                $.each(hours, function (j, m) {
                                    $weekTr.find("td[id='c" + m + "']").addClass("bg-primary")
                                });
                            });

                            //地域定向
//                             if (promoteBo.regionDirect == 0) {
//                                 //显示不限按钮
//                                 $('#regionDirect_0').show();
//                             }
//                             else if (promoteBo.regionDirect == 1) {
//                                 //显示查看设定按钮
//                                 $('#regionDirect_1').show();
//                             }
                            //地域定向弹出框
//                            $.each(promoteBo.promoteRegioBoList, function (i, n) {
//                        	$("#promoteRegioBoList").append(
//                                    "<b class='text-primary'>"
//                                            + n.regionName
//                                            + "</b> "
//                                            + (n.provinceName == null ? "全部" : n.provinceName)
//                                            + " "
//                                            + (n.provinceName != null && n.cityName == null ? "全部"
//                                                    : (n.provinceName == null ? "" : n.cityName))
//                                            + " "
//                                            + (n.provinceName != null && n.cityName != null
//                                                    && (n.plazaName == null || n.plazaName == "") ? "全部"
//                                                    : (n.cityName == null ? "" : n.plazaName)) + "<br>");
//                            });

//                             if (promoteBo.promoteTarget == null) {
//                                 $.each(promoteBo.promoteRegioBoList, function (i, n) {
//                                     $("#promoteRegioBoList").append(
//                                             "<b class='text-primary'>"
//                                             + n.regionName
//                                             + "</b> "
//                                             + (n.provinceName == null ? "全部" : n.provinceName)
//                                             + " "
//                                             + ( n.cityName == null ? "全部"
//                                                     : n.cityName)
//                                             + " "
//                                             + (n.plazaName == null ? "全部" : n.plazaName)
//                                             +
//                                             "<br>");
//                                 });
//                             } else if (promoteBo.promoteTarget == 1) {
//                                 $.each(promoteBo.promoteRegioBoList, function (i, n) {
//                                     $("#promoteRegioBoList").append(
//                                             "<b class='text-primary'>"
//                                             + n.regionName
//                                             + "</b> "
//                                             + (n.provinceName == null ? "全部" : n.provinceName)
//                                             + " "
//                                             + ( n.cityName == null ? "全部"
//                                                     : n.cityName)
//                                             + "<br>");
//                                 });

//                             } else if (promoteBo.promoteTarget == 2) {
//                                 $.each(promoteBo.promoteRegioBoList, function (i, n) {
//                                     $("#promoteRegioBoList").append(
//                                             "<b class='text-primary'>"
//                                             + n.regionName
//                                             + "</b> "
//                                             + (n.provinceName == null ? "全部" : n.provinceName)
//                                             + " "
//                                             + ( n.cityName == null ? "全部"
//                                                     : n.cityName)
//                                             + " "
//                                             + (n.plazaName == null ? "全部" : n.plazaName)
//                                             +
//                                             "<br>");
//                                 });
//                             } else if (promoteBo.promoteTarget == 3) {
//                                 $.each(promoteBo.promoteRegioBoList, function (i, n) {
//                                     $("#promoteRegioBoList").append(
//                                             "<b class='text-primary'>"
//                                             + n.regionName
//                                             + "</b> "
//                                             + (n.provinceName == null ? "全部" : n.provinceName)
//                                             + " "
//                                             + ( n.cityName == null ? "全部"
//                                                     : n.cityName)
//                                             + " "
//                                             + (n.plazaName == null ? " " : n.plazaName)
//                                             + " "
//                                             + (n.storeName == null ? "全部" : n.storeName)
//                                             +
//                                             "<br>");
//                                 });
//                             }

                            switch (promoteBo.promoteTarget) {
                                case 1:
                                    $("#promoteTarget").html("按城市投放 ");
                                    break;
                                case 2:
                                    $("#promoteTarget").html("按广场投放 ");
                                    break;
                                case 3:
                                    $("#promoteTarget").html("按门店投放 ");
                                    break;
                                default:
                                    $("#promoteTarget").html("其他 ");
                                    break;
                            }

                            if (promoteBo.targetting != null) {
                                var html = [];
                                var baseLabels = [];
                                var regionLabels = [];
                                if (promoteBo.targetPackage) {
                                    html.push("<p>定向包名称：" + promoteBo.targetPackage.name + "</p>");
                                    html.push("<p>定向包ID号：" + promoteBo.targetPackage.id + "</p>");
                                }

                                $.each(promoteBo.targetting, function (key, value) {
                                    if (key == 'ACTIVE_REGION') {
                                        $.each(value, function (i, tag) {
                                            regionLabels.push(tag.label);
                                        });
                                    } else {
                                        $.each(value, function (i, tag) {
                                            baseLabels.push(tag.label);
                                        });
                                    }
                                });

                                if (baseLabels && baseLabels.length > 0) {
                                    html.push("<p>基础定向：</p>");
                                    html.push("<span class='label label-info'>" + baseLabels.join("</span> <span class='label label-info'>") + "</span>");
                                    html.push("<p>");
                                }

                                if (regionLabels && regionLabels.length > 0) {
                                    html.push("<p>地域定向：</p>");
                                    html.push("<span class='label label-info'>" + regionLabels.join("</span> <span class='label label-info'>") + "</span>");
                                    html.push("<p>");
                                }

                                $("#programTargetting").html(html);
                            } else {
                                $("#programTargetting").html("无");
                            }

                            //投放展示类型：0不限，1每日，2每周
                            $('#displayType').val(promoteBo.displayType);

                            //投放展示频次
                            $('#displayFreq').val(promoteBo.displayFreq);

                            //投放点击类型：0不限，1每日，2每周
                            $('#clickType').val(promoteBo.clickType);

                            //投放点击频次(正整数)
                            $('#clickFreq').val(promoteBo.clickFreq);

                            //每日预算
                            $('#budget').val(promoteBo.budgetStr == null ? "" : promoteBo.budgetStr);

                            //每高出价
                            $('#maxBid').val(promoteBo.maxBidStr == null ? "" : promoteBo.maxBidStr);
                            $("#maxBidFont").text(promoteBo.settleType == 0 ? " 元/千次展示 " : " 元/点击");

                            //费用
                            $('#cost').text((promoteBo.budgetStr == null ? "" : promoteBo.budgetStr) + " 元")

                            //独占
                            if (promoteBo.settleType == 2) {
                                //费用区域展示
                                $('#costArea').show();
                            } else {
                                //显示时间定向
                                $('#timeDirect').show();

                                //显示投放展示频次
                                $('#promoteDisplay').show();

                                //显示投放点击频次
                                $('#promoteClick').show();

                                //显示每日预算
                                $('#budgetArea').show();

                                //显示每高出价
                                $('#maxBidArea').show();
                            }
                            //独占不显示"投放展示频次"，"投放点击频次"，"每日预算"和"每高出价",不显示时间定向
                            if (promoteBo.settleTypeDesc == "独占") {
                                $('#timeDirect').css('display', 'none');
                                $('#promoteDisplay').css('display', 'none');
                                $('#promoteClick').css('display', 'none');
                                $('#budgetArea').css('display', 'none');
                                $('#maxBidArea').css('display', 'none');
                            }
                        }
                        $(".fakeloader").fakeLoader().hide();
                    }
                });

                //返回投放查询列表页面
                $('#backList').click(
                        function () {
                            window.location.href = "tFfadPromoteList.html";
                        });
            });
    function timepopup() {
        var div = document.getElementById("timediv");
        div.style.display = "block";
    }
    ;
    function timesubmitpass() {
        var div = document.getElementById("timediv");
        div.style.display = "none";
    }
    ;
    function timecancelpass() {
        var div = document.getElementById("timediv");
        div.style.display = "none";
    }
    ;
    function popup() {
        var div = document.getElementById("bgdiv");
        div.style.display = "block";
    }
    ;
    function submitpass() {
        var div = document.getElementById("bgdiv");
        div.style.display = "none";
    }
    ;
    function cancelpass() {
        var div = document.getElementById("bgdiv");
        div.style.display = "none";
    }
    ;

    function showCreationPics(creativeId) {
        if ($("#btnShowCreativePics").text() == "查看素材") {
            if ($("#creativePics").html().length == 0) {
                $.getJSON("/creation/" + creativeId, function (json) {
                    var html = "";
                    if (!json || !json.result || json.result.creationPicList.length == 0) {
                        html = "无图片";
                    }

                    html += '<div class="row" style="margin-top: 10px;">';
                    var size = 12 / json.result.creationPicList.length;
                    $.each(json.result.creationPicList, function (i, pic) {
                        html += '<div class="col-md-' + size + '" style="padding-right: 5px;"><img src="' + pic.picUrl + '" width="100%" style="padding: 4px;border: 1px solid #dddddd; border-radius: 4px;" /></div>';
                    });
                    html += '</div>';

                    $("#creativePics").html(html);
                });
            }
            $("#creativePics").show();
            $("#btnShowCreativePics").html("关闭素材<i class='glyphicon glyphicon-triangle-top'></i>");
        } else {
            $("#creativePics").hide();
            $("#btnShowCreativePics").html("查看素材<i class='glyphicon glyphicon-triangle-bottom'></i>");
        }
    }
</script>
</body>
